<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Australian Elections Visualisation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Vega, Vega-Lite, Vega-Embed via CDN -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <header class="site-header">
    <div class="wrap">
      <h1 class="site-title">Australia Votes: A Nation Divided and Engaged</h1>
    </div>
  </header>

  <div class="wrap">

    <!-- ===================== MAP VISUALISATION ===================== -->
    <section class="viz-section">
    <h1>Two-Party-Preferred (TPP), House of Representatives, 2022</h1>
    <div class="grid-two"><div class="text">
    <p>
      Colour shows % TPP relative to 50%.<br>
      Blue &gt; 50% ALP; Red &gt; 50% Coalition. Hover for details.<br>
      Data: <a href="https://results.aec.gov.au/27966/website/HouseDownloadsMenu-27966-Csv.htm">AEC</a>,
      boundaries: <a href="https://data.gov.au/data/dataset/commonwealth-electoral-divisions-as-at-2-august-2021">data.gov.au</a>.
    </p>
    <p>The map shows how Australians voted in the 2022 federal election, comparing support for the two major political groups — the Australian Labor Party (ALP) and the Liberal-National Coalition. Each electorate is coloured by the two-party-preferred result, which represents which of the two main sides received more votes after preferences were distributed. Shades of blue indicate areas where Labor gained the majority, while shades of red show where the Coalition led. By looking across the country, we can see clear patterns: Labor's strength is concentrated in urban and coastal regions, while the Coalition continues to perform strongly in many rural areas. Together, these colours reveal the political landscape that shaped the 2022 outcome and the regional divides within Australia's democracy.</p>
    </div><div class="chart">
    <div id="vis"></div>
    </div></div></section>

    <!-- ===================== TURNOUT LINE CHART ===================== -->
    <section class="viz-section">
    <h2>Voter turnout over time (filter by state)</h2>
    <div class="grid-two"><div class="text">
    <p>Use the dropdown to filter; choose “All” to show every state.</p>
    </div><div class="chart">
    <div id="vis-turnout"></div>
    </div></div></section>
  </div>

  <script>
  // ===================== MAP SPEC =====================
  const mapSpec = {
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": 1000,
    "height": 620,
    "background": "white",
    "projection": { "type": "mercator", "center": [134, -26], "scale": 850 },

    "data": {
      "url": "data/ced_2021.geojson?v=2",
      "format": { "type": "json", "property": "features" }
    },

    "transform": [
      { "calculate": "datum.properties.Elect_div", "as": "DivisionNameGeo" },
      {
        "lookup": "DivisionNameGeo",
        "from": {
          "data": { "url": "data/tpp_2022.csv" },
          "key": "DivisionNm",
          "fields": [
            "Australian Labor Party Percentage",
            "Liberal/National Coalition Percentage",
            "StateAb"
          ]
        }
      },
      {
        "calculate": "isValid(datum['Australian Labor Party Percentage']) ? datum['Australian Labor Party Percentage'] - 50 : null",
        "as": "margin_alp"
      },
      {
        "calculate": "isValid(datum['Australian Labor Party Percentage']) ? (datum['Australian Labor Party Percentage'] >= 50 ? 'ALP' : 'Coalition') : 'No data'",
        "as": "winner"
      }
    ],

    "mark": { "type": "geoshape", "stroke": "#dddddd", "strokeWidth": 0.4 },

    "encoding": {
      "color": {
        "field": "margin_alp",
        "type": "quantitative",
        "title": "TPP margin (ALP – 50%)",
        "scale": { "scheme": "redblue", "domain": [-20, 0, 20] },
        "legend": { "format": "+.0f", "labelExpr": "datum.value + '%'" }
      },
      "tooltip": [
        { "field": "DivisionNameGeo", "type": "nominal", "title": "Division" },
        { "field": "StateAb", "type": "nominal", "title": "State" },
        { "field": "winner", "type": "nominal", "title": "Winner" },
        { "field": "Australian Labor Party Percentage", "type": "quantitative", "title": "ALP TPP", "format": ".1f" },
        { "field": "Liberal/National Coalition Percentage", "type": "quantitative", "title": "Coalition TPP", "format": ".1f" }
      ]
    },

    "config": {
      "view": { "stroke": null },
      "legend": { "titleFontSize": 12, "labelFontSize": 11 }
    }
  };

  vegaEmbed("#vis", "specs/map.json?v=3", { actions: false });


  // ===================== TURNOUT LINE CHART SPEC =====================
  const turnoutSpec = {
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": 1000,
    "height": 420,
    "background": "white",

    "params": [
      {
        "name": "stateFilter_turnout",
        "value": "All",
        "bind": {
          "input": "select",
          "options": ["All","NSW","VIC","QLD","WA","SA","TAS","ACT","NT"],
          "name": "State: "
        }
      }
    ],

    "data": { "url": "data/turnout_by_state.csv?v=14", "format": { "type": "csv" } },

    "transform": [
      { "filter": "stateFilter_turnout == 'All' || datum.State == stateFilter_turnout" }
    ],

    "mark": { "type": "line", "point": true },
    "encoding": {
      "x": { "field": "Year", "type": "quantitative", "title": "Election year" },
      "y": { "field": "TurnoutPct", "type": "quantitative", "title": "Turnout (%)" },
      "color": {
        "field": "State", "type": "nominal", "title": "State/Territory",
        "sort": ["NSW","VIC","QLD","WA","SA","TAS","ACT","NT"]
      },
      "tooltip": [
        { "field": "Year", "type": "quantitative" },
        { "field": "State", "type": "nominal" },
        { "field": "TurnoutPct", "type": "quantitative", "format": ".2f", "title": "Turnout (%)" }
      ]
    },

    "config": {
      "view": { "stroke": null },
      "axis": { "labelFontSize": 11, "titleFontSize": 12 },
      "legend": { "titleFontSize": 12, "labelFontSize": 11 }
    }
  };

  vegaEmbed("#vis-turnout", "specs/turnout.json?v=2", { actions: false });
  </script>

</body>
</html>


